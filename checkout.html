<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Madara Foods</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#fbbf24">
</head>
<body>

    <header class="header-container" style="position: sticky;">
        <h1>Madara<span>Foods</span></h1>
        <a href="index.html" class="nav-btn">Back to Menu</a>
    </header>

    <div class="checkout-wrapper">
        
       <div class="checkout-card table-section">
    <h2 class="section-title" style="padding-top:0; text-align:left; font-size: 1.8rem;">Your Cart</h2>
    
    <div class="table-responsive">
        <table>
            <thead>
                <tr>
                    <th style="text-align: left;">Dish</th>
                    <th>Price</th>
                    <th>Total</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="checkout-items">
                </tbody>
        </table>
    </div>
    </div>
    </div>


      <div class="checkout-card summary-section">
    <h3>Order Summary</h3>
    
    <div class="summary-row">
        <span>Subtotal</span>
        <span id="summary-subtotal">$0.00</span>
    </div>
    <div class="summary-row">
        <span>Delivery Fee</span>
        <span>$5.00</span>
    </div>
    <div class="summary-row">
        <span>Tax (5%)</span>
        <span id="summary-tax">$0.00</span>
    </div>
    
    <div class="divider"></div>
    
    <div class="summary-row total">
        <span>Total</span>
        <span id="summary-total">$0.00</span>
    </div>

    <button onclick="goToPaymentPage()" class="checkout-pay-btn">
        Proceed to Payment <i class="fas fa-arrow-right"></i>
    </button>
    
    <button onclick="triggerCancel()" class="checkout-cancel-btn">
        Cancel Order
    </button>
</div>

<div id="confirm-modal" class="modal-overlay hidden">
        <div class="modal-content mini-modal">
            <div class="icon-box-modal warning">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h3>Are you sure?</h3>
            <p id="confirm-msg">Do you really want to remove this item?</p>
            <div class="modal-actions">
                <button onclick="closePopup('confirm-modal')" class="btn-secondary">No, Keep it</button>
                <button id="yes-btn" class="btn-danger" onclick="confirmAction()">Yes, Delete</button>
            </div>
        </div>
    </div>

    <div id="success-modal" class="modal-overlay hidden">
        <div class="modal-content mini-modal">
            <div class="icon-box-modal success">
                <i class="fas fa-check-circle"></i>
            </div>
            <h3>Order Placed!</h3>
            <p>Your food is being prepared. Get ready to eat!</p>
            <button onclick="finishOrder()" class="btn-primary-full">Awesome!</button>
        </div>
    </div>

    <div id="payment-modal" class="modal-overlay hidden">
        <div class="modal-content payment-card-box">
            <button class="close-modal-btn" onclick="closePopup('payment-modal')">&times;</button>
            <h3 style="color:white; margin-bottom:20px;">Secure Payment</h3>
            <div class="payment-total">
                <span>Total:</span> <span id="pay-amount-display">$0.00</span>
            </div>
            <button onclick="processPayment()" class="btn-primary-full">Confirm Payment</button>
        </div>
    </div>
    <script>
        function goToPaymentPage() {
            const cart = JSON.parse(localStorage.getItem("cart")) || [];
            if(cart.length === 0) {
                // Using Toastify if available, else alert
                if(typeof Toastify !== 'undefined') {
                    Toastify({ text: "Your cart is empty!", style: { background: "#ef4444" } }).showToast();
                } else {
                    alert("Cart is empty!");
                }
                return;
            }
            // Save the total to use on the next page
            const total = document.getElementById("summary-total").innerText;
            localStorage.setItem("checkoutTotal", total);
            
            // REDIRECT
            window.location.href = "payment.html";
        }
    </script>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
   <script src="search.js"></script>

</body>
</html>